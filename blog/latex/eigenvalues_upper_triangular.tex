\documentclass{article}
\input{alex-fatma-packages}
\input{alex-fatma-macros}
\usepackage{graphicx}
\graphicspath{ {../} }
\usepackage[numbers,sort&compress,square,comma]{natbib}
\title{Eigenvalues of block matrices with upper triangular blocks}
\date{2021-01-31}
\begin{document}

This past week, \href{https://rjjiang.github.io/}{Rujun Jiang} and I posted a \href{https://arxiv.org/abs/2101.12141}{preprint} on \textit{almost} simultaneously diagonalizable quadratic forms (and other related ideas). At some point in the future, I will try write a short expository blog post about the main contributions of this work.
Today, I'm simply going to present a neat fact\footnote{I don't claim that this is new in any way and imagine this fact is known somewhere. On the other hand, I was personally unable to find a reference for it and would appreciate if anyone had pointers for me!} about the eigenvalues of block matrices with upper triangular blocks that I needed/learned/proved while working on this project.

\rule{0.5\linewidth}{\linethickness}

First, let's define the sets of matrices we care about.

\begin{definition}
A matrix $T\in\C^{n \by m}$ is \textit{upper triangular} if
\begin{align*}
m -j + i > \min(n,m) \implies T_{i,j} = 0.
\end{align*}
\end{definition}
Pictorially, an upper triangular matrix looks like
\begin{align*}
\begin{pmatrix}
	* & \cdots & *\\
	 & \ddots & \vdots\\
	 &  & *\\
	0 & \cdots & 0\\
	\vdots & \ddots & \vdots\\
	0 & \cdots & 0
\end{pmatrix}\quad\text{or}\quad
\begin{pmatrix}
	0 & \cdots & 0 & * & \cdots & *\\
	\vdots & \ddots & \vdots & & \ddots & \vdots\\
	0 & \cdots & 0 & &  & *
\end{pmatrix}
\end{align*}
when $n\geq m$ and $n\leq m$ respectively.

Suppose $(n_1,\dots,n_k)$ is such that $\sum_p n_p = n$. Given $T\in\C^{n\by n}$, we will let $[T]_{p,q}$ denote the $(p,q)$th \textit{block} of $T$ so that $[T]_{p,q} \in\C^{n_p\times n_q}$.

\begin{proposition}
Let $(n_1,\dots,n_k)$ such that $\sum_p n_p = n$ and $T\in\C^{n\by n}$ such that $[T]_{p,q}$ is upper triangular for all $p,q\in[k]$. Then, the determinant of $T$ depends only on the diagonal entries of blocks $[T]_{p,q}$ where $n_p = n_q$.
\end{proposition}

Pictorially (for the case $(n_1,n_2,n_3) = (2,2,3)$), this proposition says that the determinant of a matrix with support
% \begin{align*}
% \left(\begin{array}
% 	{c|c|c}
% 	\begin{matrix}@ & *\\& @\end{matrix} &
% 		\begin{matrix}@ & *\\& @\end{matrix} &
% 		\begin{matrix}\hphantom{@} & * & *\\&   & *\end{matrix}\\\hline
% 	\begin{matrix}@ & *\\& @\end{matrix} &
% 		\begin{matrix}@ & *\\& @\end{matrix} &
% 		\begin{matrix}\hphantom{@} & * & *\\&   & *\end{matrix}\\\hline
% 	\begin{matrix}* & *\\& *\\ & \end{matrix} &
% 		\begin{matrix}* & *\\& *\\ & \end{matrix} &
% 		\begin{matrix}@ & * & *\\& @ & *\\&& @\end{matrix}
% \end{array}\right)
% \end{align*}
\begin{align*}
\left(\begin{array}
	{cc|cc|ccc}
	@ & * & @ & * &  & * & *\\
	& @ & & @ & & & *\\\hline
	@ & * & @ & * &  & * & *\\
	& @ & & @ & & & *\\\hline
	* & * & * & * & @ & * & *\\
	& * & & * & & @ & *\\
	& & & & & & @
\end{array}\right)
\end{align*}

depends only on the entries in the $@$ positions.


At a high level, this proposition states that the determinant (whence also the characteristic polynomial and eigenvalues) of a block matrix with upper triangular blocks depends on only a very small number of entries of the block matrix.

\rule{0.5\linewidth}{\linethickness}

I will now present a really neat proof of this fact using a proof strategy that \href{http://www.cs.cmu.edu/~kpratt/}{Kevin Pratt} suggested.

\begin{proof}
We will show the stronger\footnote{This stronger statement in fact implies that the permanent, or in fact any \textit{generalized matrix function}, of such a matrix depends only on a small number of entries.} statement: For any permutation $\sigma \in S_n$, if $\prod_i T_{i,\sigma(i)}$ is nonzero, then for every $i$, we have that $(i,\sigma(i))$ is a diagonal entry of some block $[T]_{p,q}$ where $n_p = n_q$.

First assign a weight $w_i$ to each $i\in[n]$: Given $i\in[n]$, let $p$ denote the block containing $i$ and let $r$ denote position of $i$ within the $p$th block. Set
\begin{align*}
w_i \coloneqq r - n_p/2.
\end{align*}
Next for each $i,j\in[n]$, assign the weight $w_{i,j}\coloneqq w_j - w_i$.

Equivalently, if $i,j$ corresponds to $p,q,r,s$, then set
\begin{align*}
w_{i,j} \coloneqq (s- r) + (n_p + n_q)/2 - n_q.
\end{align*}

Next, as $T$ has upper triangular blocks, we also have that
\begin{align*}
T_{i,j}\neq 0 \implies (s-r) + \min(n_p,n_q) - n_q\geq 0.
\end{align*}

We deduce that if $T_{i,j}\neq 0$, then $w_{i,j}\geq 0$. Furthermore, if $T_{i,j}\neq 0$ and $w_{i,j} = 0$, then it must be the case that $n_p = n_q$ and $s = r$.


Finally, note that for any permutation $\sigma\in S_n$, we have
\begin{align*}
\sum_{i} w_{i,\sigma(i)} = \sum_i w_{\sigma(i)} - \sum_i w_i = 0.
\end{align*}

This concludes the proof as then if $\prod_i T_{i,\sigma(i)}$ is nonzero, it must be the case that for all $i\in[n]$, we have $T_{i,\sigma(i)}\neq 0$ and $w_{i,\sigma(i)} = 0$.
\end{proof}

\rule{0.5\linewidth}{\linethickness}

Intuitively, this proof looks at a matrix with upper triangular blocks and compares its support with some carefully constructed weighting of its entries. For $(n_1,n_2,n_3) = (2,2,3)$, this looks like
\begin{gather*}
\left(\begin{array}
	{cc|cc|ccc}
	* & * & * & * &  & * & *\\
	& * & & * & & & *\\\hline
	* & * & * & * &  & * & *\\
	& * & & * & & & *\\\hline
	* & * & * & * & * & * & *\\
	& * & & * & & * & *\\
	& & & & & & *
\end{array}\right),\\
\left(\begin{array}
	{cc|cc|ccc}
	0 & 1 & 0 & 1 & -0.5 & 0.5 & 1.5\\
	-1 & 0 & -1 & 0 & -1.5 & -0.5 & 0.5\\\hline
	0 & 1 & 0 & 1 & -0.5 & 0.5 & 1.5\\
	-1 & 0 & -1 & 0 & -1.5 & -0.5 & 0.5\\\hline
	0.5 & 1.5 & 0.5 & 1.5 & 0 & 1 & 2\\
	-0.5& 0.5 & -0.5 & 1.5 & -1 & 0 & 1\\
	-1.5 & -0.5 & -1.5 & -0.5 & -2 & -1 & 0
\end{array}\right).
\end{gather*}
The proof then observes that: 
The support of $T$ corresponds exactly to the entries with nonnegative weight. Additionally, the intersection of the support of $T$ with the entries of weight zero is exactly the set of diagonal entries of blocks $[T]_{p,q}$ where $n_p = n_q$.

\rule{0.5\linewidth}{\linethickness}



In the setting of our paper, we have that the blocks of $T$ are furthermore Toeplitz, i.e., their entries are constant along each diagonal. Then using the above proposition (along with other more elementary facts), we are then able to make crazy-looking statements such as
\begin{align*}
\begin{pmatrix}
	a & * & b & * & & * & *\\
	  & a & & b & & & *\\
	c & * & d & * & & * & *\\
	  & c & & d & & & *\\
	* & * & * & * & e & * & *\\
	 & * & & * & & e & *\\
	 &  & &  & &  & e\\
\end{pmatrix}
&\stackrel{\sigma}{=}
\begin{pmatrix}
	a &  & b &  & &  & \\
	  & a & & b & & & \\
	c &  & d &  & &  & \\
	  & c & & d & & & \\
	 &  &  &  & e &  & \\
	 &  & &  & & e & \\
	 &  & &  & &  & e\\
\end{pmatrix}\\
&\stackrel{\sigma}{=}
\begin{pmatrix}
	a & b&\\
	c & d&\\
	&&e
\end{pmatrix},
\end{align*}
where $\stackrel{\sigma}{=}$ indicates that the matrices have the same spectrum.
\end{document}